{
    "width": 800,
    "height": 600,
    "config": {
        "axis": {
            "bandPosition": 0.5,
            "domain": false,
            "domainWidth": 2,
            "domainColor": "rgb(0, 0, 0)",
            "gridColor": "rgb(230, 230, 230)",
            "labelFont": "adobe-clean, 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Trebuchet MS', 'Lucida Grande', sans-serif",
            "labelFontSize": 14,
            "labelFontWeight": "normal",
            "labelPadding": 8,
            "labelOverlap": true,
            "labelColor": "rgb(34, 34, 34)",
            "ticks": false,
            "tickColor": "rgb(213, 213, 213)",
            "tickRound": true,
            "tickSize": 8,
            "tickCap": "round",
            "tickWidth": 1,
            "titleAnchor": "middle",
            "titleColor": "rgb(34, 34, 34)",
            "titleFont": "adobe-clean, 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Trebuchet MS', 'Lucida Grande', sans-serif",
            "titleFontSize": 14,
            "titleFontWeight": "bold",
            "titlePadding": 16
        },
        "range": {
            "category": [
                "rgb(15, 181, 174)",
                "rgb(64, 70, 202)",
                "rgb(246, 133, 17)",
                "rgb(222, 61, 130)",
                "rgb(126, 132, 250)",
                "rgb(114, 224, 106)",
                "rgb(20, 122, 243)",
                "rgb(115, 38, 211)",
                "rgb(232, 198, 0)",
                "rgb(203, 93, 0)",
                "rgb(0, 143, 93)",
                "rgb(188, 233, 49)",
                "rgb(90, 169, 250)",
                "rgb(192, 56, 204)",
                "rgb(245, 107, 183)",
                "rgb(255, 226, 46)"
            ],
            "diverging": [
                "rgb(88, 0, 0)",
                "rgb(121, 38, 11)",
                "rgb(156, 69, 17)",
                "rgb(189, 101, 26)",
                "rgb(221, 134, 41)",
                "rgb(245, 173, 82)",
                "rgb(254, 214, 147)",
                "rgb(255, 255, 224)",
                "rgb(187, 228, 209)",
                "rgb(118, 199, 190)",
                "rgb(62, 168, 166)",
                "rgb(32, 130, 136)",
                "rgb(7, 103, 105)",
                "rgb(0, 73, 75)",
                "rgb(0, 44, 45)"
            ],
            "ordinal": [
                "rgb(15, 181, 174)",
                "rgb(64, 70, 202)",
                "rgb(246, 133, 17)",
                "rgb(222, 61, 130)",
                "rgb(126, 132, 250)",
                "rgb(114, 224, 106)",
                "rgb(20, 122, 243)",
                "rgb(115, 38, 211)",
                "rgb(232, 198, 0)",
                "rgb(203, 93, 0)",
                "rgb(0, 143, 93)",
                "rgb(188, 233, 49)",
                "rgb(90, 169, 250)",
                "rgb(192, 56, 204)",
                "rgb(245, 107, 183)",
                "rgb(255, 226, 46)"
            ],
            "ramp": [
                "rgb(253, 231, 37)",
                "rgb(210, 226, 27)",
                "rgb(165, 219, 54)",
                "rgb(122, 209, 81)",
                "rgb(84, 197, 104)",
                "rgb(53, 183, 121)",
                "rgb(34, 168, 132)",
                "rgb(31, 152, 139)",
                "rgb(35, 136, 142)",
                "rgb(42, 120, 142)",
                "rgb(49, 104, 142)",
                "rgb(57, 86, 140)",
                "rgb(65, 68, 135)",
                "rgb(71, 47, 125)",
                "rgb(72, 26, 108)",
                "rgb(68, 1, 84)"
            ]
        },
        "background": "transparent",
        "legend": {
            "columnPadding": 20,
            "labelColor": "rgb(34, 34, 34)",
            "labelFont": "adobe-clean, 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Trebuchet MS', 'Lucida Grande', sans-serif",
            "labelFontSize": 14,
            "labelFontWeight": "normal",
            "labelLimit": 184,
            "layout": {
                "bottom": {
                    "anchor": "middle",
                    "direction": "horizontal",
                    "center": true,
                    "offset": 24,
                    "bounds": "full",
                    "margin": 48
                },
                "top": {
                    "anchor": "middle",
                    "direction": "horizontal",
                    "center": true,
                    "offset": 24,
                    "bounds": "full",
                    "margin": 48
                },
                "left": {
                    "anchor": "middle",
                    "direction": "vertical",
                    "center": false,
                    "offset": 24,
                    "bounds": "full",
                    "margin": 24
                },
                "right": {
                    "anchor": "middle",
                    "direction": "vertical",
                    "center": false,
                    "offset": 24,
                    "bounds": "full",
                    "margin": 24
                }
            },
            "rowPadding": 8,
            "symbolSize": 250,
            "symbolType": "M -0.55 -1 h 1.1 a 0.45 0.45 0 0 1 0.45 0.45 v 1.1 a 0.45 0.45 0 0 1 -0.45 0.45 h -1.1 a 0.45 0.45 0 0 1 -0.45 -0.45 v -1.1 a 0.45 0.45 0 0 1 0.45 -0.45 z",
            "symbolStrokeColor": "rgb(70, 70, 70)",
            "titleColor": "rgb(34, 34, 34)",
            "titleFont": "adobe-clean, 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Trebuchet MS', 'Lucida Grande', sans-serif",
            "titleFontSize": 14,
            "titlePadding": 8
        },
        "arc": {
            "fill": "rgb(15, 181, 174)"
        },
        "area": {
            "fill": "rgb(15, 181, 174)",
            "opacity": 0.8
        },
        "line": {
            "strokeWidth": 2,
            "stroke": "rgb(15, 181, 174)"
        },
        "path": {
            "stroke": "rgb(15, 181, 174)"
        },
        "rect": {
            "strokeWidth": 0,
            "stroke": "rgb(150, 206, 253)",
            "fill": "rgb(15, 181, 174)"
        },
        "rule": {
            "stroke": "rgb(0, 0, 0)",
            "strokeWidth": 2
        },
        "shape": {
            "stroke": "rgb(15, 181, 174)"
        },
        "symbol": {
            "strokeWidth": 2,
            "size": 100,
            "fill": "rgb(15, 181, 174)"
        },
        "text": {
            "fill": "rgb(34, 34, 34)",
            "font": "adobe-clean, 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Trebuchet MS', 'Lucida Grande', sans-serif",
            "fontSize": 14
        },
        "title": {
            "offset": 10,
            "font": "adobe-clean, 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Ubuntu, 'Trebuchet MS', 'Lucida Grande', sans-serif",
            "fontSize": 18,
            "color": "rgb(34, 34, 34)"
        }
    },
    "autosize": {
        "type": "fit",
        "contains": "padding",
        "resize": true
    },
    "data": [
        {
            "name": "table",
            "values": [
                {
                    "browser": "Chrome",
                    "value": 5,
                    "operatingSystem": "Windows",
                    "order": 2,
                    "percentLabel": "50%",
                    "rscMarkId": 1,
                    "rscSeriesId": "Windows"
                },
                {
                    "browser": "Chrome",
                    "value": 3,
                    "operatingSystem": "Mac",
                    "order": 1,
                    "percentLabel": "30%",
                    "rscMarkId": 2,
                    "rscSeriesId": "Mac"
                },
                {
                    "browser": "Firefox",
                    "value": 3,
                    "operatingSystem": "Mac",
                    "order": 1,
                    "percentLabel": "42.6%",
                    "rscMarkId": 5,
                    "rscSeriesId": "Mac"
                },
                {
                    "browser": "Firefox",
                    "value": 3,
                    "operatingSystem": "Windows",
                    "order": 2,
                    "percentLabel": "42.6%",
                    "rscMarkId": 4,
                    "rscSeriesId": "Windows"
                },
                {
                    "browser": "Safari",
                    "value": 0,
                    "operatingSystem": "Mac",
                    "order": 1,
                    "rscMarkId": 8,
                    "rscSeriesId": "Mac"
                },
                {
                    "browser": "Safari",
                    "value": 3,
                    "operatingSystem": "Windows",
                    "order": 2,
                    "percentLabel": "75%",
                    "rscMarkId": 7,
                    "rscSeriesId": "Windows"
                },

            ],
            "transform": [
                {
                    "type": "identifier",
                    "as": "rscMarkId"
                },
                {
                    "type": "formula",
                    "as": "rscSeriesId",
                    "expr": "datum.operatingSystem"
                }
            ]
        },
        {
            "name": "filteredTable",
            "source": "table",
            "transform": [
                {
                    "type": "filter",
                    "expr": "indexof(hiddenSeries, datum.rscSeriesId) === -1"
                },
                {
                    "type": "formula",
                    "as": "bar0_dodgeGroup",
                    "expr": "datum.operatingSystem"
                },
                {
                    "type": "formula",
                    "as": "bar0_selectedGroupId",
                    "expr": "datum.rscMarkId"
                }
            ]
        },
        {
            "name": "yLinear1Domain",
            "source": "filteredTable",
            "transform": [
                { "type": "filter", "expr": "datum.rscSeriesId !== lastRscSeriesId" }
            ]
        },
        {
            "name": "yLinear2Domain",
            "source": "filteredTable",
            "transform": [
                { "type": "filter", "expr": "datum.rscSeriesId === lastRscSeriesId" }
            ]
        },
        {
            "name": "bar0_selectedData",
            "source": "filteredTable",
            "transform": [
                {
                    "type": "filter",
                    "expr": "selectedGroup === datum.bar0_selectedGroupId"
                }
            ]
        },
        {
            "name": "legend0Aggregate",
            "source": "table",
            "transform": [
                {
                    "type": "aggregate",
                    "groupby": [
                        "operatingSystem"
                    ]
                },
                {
                    "type": "formula",
                    "as": "legend0Entries",
                    "expr": "datum.operatingSystem"
                }
            ]
        }
    ],
    "background": "transparent",
    "signals": [
        {
            "name": "chartBackgroundColor",
            "value": "rgb(255, 255, 255)"
        },
        {
            "name": "lastRscSeriesId",
            "value": null,
            "update": "length(domain('color')) > 0 ? peek(domain('color')) : null"
        },
        {
            "name": "firstRscSeriesId",
            "value": null,
            "update": "length(domain('color')) > 0 ? domain('color')[0] : null"
        },
        {
            "name": "colors",
            "value": [
                [
                    "rgb(15, 181, 174)"
                ],
                [
                    "rgb(64, 70, 202)"
                ],
                [
                    "rgb(246, 133, 17)"
                ],
                [
                    "rgb(222, 61, 130)"
                ],
                [
                    "rgb(126, 132, 250)"
                ],
                [
                    "rgb(114, 224, 106)"
                ],
                [
                    "rgb(20, 122, 243)"
                ],
                [
                    "rgb(115, 38, 211)"
                ],
                [
                    "rgb(232, 198, 0)"
                ],
                [
                    "rgb(203, 93, 0)"
                ],
                [
                    "rgb(0, 143, 93)"
                ],
                [
                    "rgb(188, 233, 49)"
                ]
            ]
        },
        {
            "name": "lineTypes",
            "value": [
                [
                    []
                ],
                [
                    [
                        7,
                        4
                    ]
                ],
                [
                    [
                        2,
                        3
                    ]
                ],
                [
                    [
                        2,
                        3,
                        7,
                        4
                    ]
                ],
                [
                    [
                        11,
                        4
                    ]
                ],
                [
                    [
                        5,
                        2,
                        11,
                        2
                    ]
                ]
            ]
        },
        {
            "name": "opacities",
            "value": [
                [
                    1
                ]
            ]
        },
        {
            "name": "hiddenSeries",
            "value": []
        },
        {
            "name": "highlightedItem",
            "value": null,
            "on": [
                {
                    "events": "@bar0:mouseover",
                    "update": "datum.rscMarkId"
                },
                {
                    "events": "@bar0:mouseout",
                    "update": "null"
                }
            ]
        },
        {
            "name": "highlightedGroup",
            "value": null
        },
        {
            "name": "highlightedSeries",
            "value": null,
            "on": [
                {
                    "events": "@legend0_legendEntry:mouseover",
                    "update": "indexof(hiddenSeries, domain(\"legend0Entries\")[datum.index]) === -1 ? domain(\"legend0Entries\")[datum.index] : null"
                },
                {
                    "events": "@legend0_legendEntry:mouseout",
                    "update": "null"
                }
            ]
        },
        { // Signal RENAMED to highlightedGroup
            "name": "mousedOverSeries",
            "value": null,
            "on": [
                {"events": "@bar0:mouseover", "update": "datum.rscSeriesId"},
                {"events": "@bar0:mouseout",  "update": "null"}
            ]
        },
        {
            "name": "selectedItem",
            "value": null
        },
        {
            "name": "selectedSeries",
            "value": null
        },
        {
            "name": "selectedGroup",
            "value": null
        },
        {
            "name": "paddingInner",
            "value": 0.4
        }
    ],
    "scales": [
        {
            "name": "color",
            "type": "ordinal",
            "range": [
                "rgb(15, 181, 174)",
                "rgb(64, 70, 202)",
                "rgb(246, 133, 17)",
                "rgb(222, 61, 130)",
                "rgb(126, 132, 250)",
                "rgb(114, 224, 106)",
                "rgb(20, 122, 243)",
                "rgb(115, 38, 211)",
                "rgb(232, 198, 0)",
                "rgb(203, 93, 0)",
                "rgb(0, 143, 93)",
                "rgb(188, 233, 49)"
            ],
            "domain": {
                "data": "table",
                "fields": [
                    "operatingSystem"
                ]
            }
        },
        {
            "name": "yLinear1",
            "type": "linear",
            "range": "height",
            "domain": {
                "data": "yLinear1Domain",
                "fields": [
                    "value"
                ]
            },
            "nice": true,
            "zero": true
        },
        {
            "name": "yLinear2",
            "type": "linear",
            "range": "height",
            "domain": {
                "data": "yLinear2Domain",
                "fields": [
                    "value"
                ]
            },
            "nice": true,
            "zero": true
        },
        {
            "name": "xBand",
            "type": "band",
            "range": "width",
            "domain": {
                "data": "filteredTable",
                "fields": [
                    "browser"
                ]
            },
            "paddingInner": 0.4,
            "paddingOuter": 0.2
        },
        {
            "name": "legend0Entries",
            "type": "ordinal",
            "domain": {
                "data": "legend0Aggregate",
                "field": "legend0Entries"
            }
        }
    ],
    "marks": [
        {
            "name": "bar0_group",
            "type": "group",
            "from": {
                "facet": {
                    "data": "filteredTable",
                    "name": "bar0_facet",
                    "groupby": "browser"
                }
            },
            "encode": {
                "enter": {
                    "x": {
                        "scale": "xBand",
                        "field": "browser"
                    }
                }
            },
            "signals": [
                {
                    "name": "width",
                    "update": "bandwidth(\"xBand\")"
                }
            ],
            "scales": [
                {
                    "name": "bar0_position",
                    "type": "band",
                    "range": "width",
                    "domain": {
                        "data": "filteredTable",
                        "field": "bar0_dodgeGroup"
                    },
                    "paddingInner": 0.4
                }
            ],
            "marks": [
                {
                    "name": "bar0_background",
                    "from": {
                        "data": "bar0_facet"
                    },
                    "type": "rect",
                    "interactive": false,
                    "encode": {
                        "enter": {
                            "y": [
                                {
                                    "test": "datum.rscSeriesId === lastRscSeriesId", 
                                    "scale": "yLinear2", "value": 0
                                }, 
                                {
                                    "scale": "yLinear1", 
                                    "value": 0
                                }
                            ],
                            "y2": [
                                {
                                    "test": "datum.rscSeriesId === lastRscSeriesId", 
                                    "scale": "yLinear2", "field": "value"
                                }, 
                                {
                                    "scale": "yLinear1", 
                                    "field": "value"
                                }  
                            ],
                            "cornerRadiusTopLeft": [
                                {
                                    "test": "datum.value > 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "cornerRadiusTopRight": [
                                {
                                    "test": "datum.value > 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "cornerRadiusBottomLeft": [
                                {
                                    "test": "datum.value < 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "cornerRadiusBottomRight": [
                                {
                                    "test": "datum.value < 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "fill": {
                                "signal": "chartBackgroundColor"
                            }
                        },
                        "update": {
                            "x": {
                                "scale": "bar0_position",
                                "field": "bar0_dodgeGroup"
                            },
                            "width": {
                                "scale": "bar0_position",
                                "band": 1
                            }
                        }
                    }
                },
                {
                    "name": "bar0",
                    "from": {
                        "data": "bar0_facet"
                    },
                    "type": "rect",
                    "interactive": true,
                    "encode": {
                        "enter": {
                            "y": [
                                {
                                    "test": "datum.rscSeriesId === lastRscSeriesId", 
                                    "scale": "yLinear2", "value": 0
                                }, 
                                {
                                    "scale": "yLinear1", 
                                    "value": 0
                                }
                            ],
                            "y2": [
                                {
                                    "test": "datum.rscSeriesId === lastRscSeriesId", 
                                    "scale": "yLinear2", "field": "value"
                                }, 
                                {
                                    "scale": "yLinear1", 
                                    "field": "value"
                                }  
                            ],
                            "cornerRadiusTopLeft": [
                                {
                                    "test": "datum.value > 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "cornerRadiusTopRight": [
                                {
                                    "test": "datum.value > 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "cornerRadiusBottomLeft": [
                                {
                                    "test": "datum.value < 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "cornerRadiusBottomRight": [
                                {
                                    "test": "datum.value < 0",
                                    "value": 6
                                },
                                {
                                    "value": 0
                                }
                            ],
                            "fill": {
                                "scale": "color",
                                "field": "operatingSystem"
                            },
                            "fillOpacity": {
                                "value": 1
                            },
                            "tooltip": {
                                "signal": "merge(datum, {'rscComponentName': 'bar0'})"
                            }
                        },
                        "update": {
                            "x": {
                                "scale": "bar0_position",
                                "field": "bar0_dodgeGroup"
                            },
                            "width": {
                                "scale": "bar0_position",
                                "band": 1
                            },
                            "cursor": {
                                "value": "pointer"
                            },
                            "opacity": [
                                {
                                    "test": "!isValid(selectedGroup) && selectedItem && selectedItem !== datum.rscMarkId",
                                    "value": 0.2
                                },
                                {
                                    "test": "isValid(selectedItem) && selectedItem === datum.rscMarkId",
                                    "value": 1
                                },
                                {
                                    "test": "isValid(selectedGroup) && selectedGroup === datum.bar0_selectedGroupId",
                                    "value": 1
                                },
                                {
                                    "test": "isValid(selectedGroup) && selectedGroup !== datum.bar0_selectedGroupId",
                                    "value": 0.2
                                },
                                {
                                    "test": "isArray(highlightedItem) && length(highlightedItem) > 0 && indexof(highlightedItem, datum.rscMarkId) === -1",
                                    "value": 0.2
                                },
                                {
                                    "test": "!isArray(highlightedItem) && isValid(highlightedItem) && highlightedItem !== datum.rscMarkId",
                                    "value": 0.2
                                },
                                {
                                    "test": "isValid(highlightedSeries) && highlightedSeries !== datum.rscSeriesId",
                                    "value": 0.2
                                },
                                {
                                    "value": 1
                                }
                            ],
                            "stroke": [
                                {
                                    "test": "(selectedItem && selectedItem === datum.rscMarkId) || (selectedGroup && selectedGroup === datum.bar0_selectedGroupId)",
                                    "value": "rgb(20, 115, 230)"
                                },
                                {
                                    "scale": "color",
                                    "field": "operatingSystem"
                                }
                            ],
                            "strokeDash": [
                                {
                                    "test": "isValid(selectedItem) && selectedItem === datum.rscMarkId",
                                    "value": []
                                },
                                {
                                    "value": []
                                }
                            ],
                            "strokeWidth": [
                                {
                                    "test": "(isValid(selectedItem) && selectedItem === datum.rscMarkId) || (isValid(selectedGroup) && selectedGroup === datum.bar0_selectedGroupId)",
                                    "value": 2
                                },
                                {
                                    "value": 0
                                }
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "xBaseline",
            "description": "xBaseline",
            "type": "rule",
            "interactive": false,
            "encode": {
                "update": {
                    "x": {
                        "value": 0
                    },
                    "x2": {
                        "signal": "width"
                    },
                    "y": {
                        "scale": "yLinear1",
                        "value": 0
                    }
                }
            }
        }
    ],
    "legends": [
        {
            "fill": "legend0Entries",
            "direction": "horizontal",
            "orient": "bottom",
            "title": "Operating system",
            "encode": {
                "entries": {
                    "name": "legend0_legendEntry",
                    "interactive": true,
                    "enter": {},
                    "update": {
                        "fill": {
                            "value": "transparent"
                        }
                    }
                },
                "symbols": {
                    "enter": {},
                    "update": {
                        "fill": [
                            {
                                "signal": "scale('color', data('legend0Aggregate')[datum.index].operatingSystem)"
                            }
                        ],
                        "stroke": [
                            {
                                "signal": "scale('color', data('legend0Aggregate')[datum.index].operatingSystem)"
                            }
                        ],
                        "opacity": [
                            {
                                "test": "isValid(highlightedSeries) && datum.value !== highlightedSeries",
                                "value": 0.2
                            },
                            {
                                "value": 1
                            }
                        ]
                    }
                },
                "labels": {
                    "update": {
                        "opacity": [
                            {
                                "test": "isValid(highlightedSeries) && datum.value !== highlightedSeries",
                                "value": 0.2
                            },
                            {
                                "value": 1
                            }
                        ],
                        "fill": [
                            {
                                "value": "rgb(70, 70, 70)"
                            }
                        ]
                    }
                }
            },
            "columns": {
                "signal": "floor(width / 220)"
            }
        }
    ],
    "axes": [
        {
            "scale": "xBand",
            "orient": "bottom",
            "grid": false,
            "ticks": false,
            "title": "Browser",
            "labelAngle": 0,
            "labelFontWeight": "normal",
            "labels": true,
            "labelAlign": "center",
            "labelBaseline": "top",
            "encode": {
                "labels": {
                    "update": {
                        "text": [
                            {
                                "test": "isNumber(datum['value']) && abs(datum['value']) >= 1000",
                                "signal": "upper(replace(format(datum['value'], '.3~s'), /(\\d+)G/, '$1B'))"
                            },
                            {
                                "signal": "datum.value"
                            }
                        ]
                    }
                }
            }
        },
        {
            "scale": "yLinear1",
            "orient": "left",
            "grid": false,
            "ticks": true,
            "tickCount": {
                "signal": "clamp(ceil(height/100), 2, 10)"
            },
            "title": "Downloads",
            "labelAngle": 0,
            "labelFontWeight": "normal",
            "labels": true,
            "labelAlign": "right",
            "labelBaseline": "middle",
            "encode": {
                "title": {
                    "update": {
                        "fill": [
                            {
                                "test": "length(domain('color')) -1 === 1",
                                "signal": "scale('color', firstRscSeriesId)"
                            },
                            {"value": "black"}
                        ],
                        "fillOpacity": [
                            {
                                "test": "mousedOverSeries === lastRscSeriesId",
                                "value": "0.3"
                            }
                        ]
                    }
                },
                "labels": {
                    "update": {
                        "fill": [
                            {
                                "test": "length(domain('color')) - 1 === 1",
                                "signal": "scale('color', firstRscSeriesId)"
                            },
                            {"value": "black"}
                        ],
                        "fillOpacity": [
                            {
                                "test": "mousedOverSeries === lastRscSeriesId",
                                "value": "0.3"
                            }
                        ],
                        "text": [
                            {
                                "test": "isNumber(datum['value']) && abs(datum['value']) >= 1000",
                                "signal": "upper(replace(format(datum['value'], '.3~s'), /(\\d+)G/, '$1B'))"
                            },
                            {
                                "signal": "datum.value"
                            }
                        ]
                    }
                }
            },
            "domain": false,
            "domainWidth": 2
        },
        {
            "scale": "yLinear2",
            "orient": "right",
            "ticks": true,
            "tickCount": {
                "signal": "clamp(ceil(height/100), 2, 10)"
            },
            "title": "Mac Downloads",
            "labelAngle": 0,
            "labelFontWeight": "normal",
            "labels": true,
            "labelAlign": "left",
            "labelBaseline": "middle",
            "encode": {
                "title": {
                    "enter": {
                        "fill": [
                            {"signal": "scale('color', lastRscSeriesId)"}
                        ]
                    },
                    "update": {
                        "fillOpacity": [
                            {
                                "test": "isValid(mousedOverSeries) && mousedOverSeries !== lastRscSeriesId",
                                "value": "0.3"
                            }
                        ]
                    }
                },
                "labels": {
                    "enter": {
                        "fill": [
                            {"signal": "scale('color', lastRscSeriesId)"}
                        ]
                    },
                    "update": {
                        "text": [
                            {
                                "test": "isNumber(datum['value']) && abs(datum['value']) >= 1000",
                                "signal": "upper(replace(format(datum['value'], '.3~s'), /(\\d+)G/, '$1B'))"
                            },
                            {
                                "signal": "datum.value"
                            }
                        ],
                        "fillOpacity": [
                            {
                                "test": "isValid(mousedOverSeries) && mousedOverSeries !== lastRscSeriesId",
                                "value": "0.3"
                            }
                        ]
                    }
                }
            },
            "domain": false,
            "domainWidth": 2
        },
    ]
}